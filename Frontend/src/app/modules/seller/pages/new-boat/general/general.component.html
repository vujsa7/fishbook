<div class="form-wrapper d-flex flex-column align-items-center">
    <form [formGroup]="newBoatForm">
        <div class="form-fields">
            <div class="input-container" [ngClass]="{'input-container-error' : (newBoatForm.controls.boatName.touched && newBoatForm.controls.boatName.errors?.['required'])}">
                <input id="boatName" type="text" formControlName="boatName" name="boatName" (focus)="newBoatForm.controls.boatName.markAsUntouched()" required>
                <label for="boatName" class="input-label">Boat name</label>
                <span class="error-message" *ngIf="newBoatForm.controls.boatName.touched && newBoatForm.controls.boatName.errors?.['required']">Boat name cannot be empty.</span>
            </div>
            <span class="maxchar">0/40max</span>
        </div>
        <div class="form-fields">
            <div class="input-container description" [ngClass]="{'input-container-error' : (newBoatForm.controls.description.touched && newBoatForm.controls.description.errors?.['required'])}">
                <textarea id="description" formControlName="description" maxLength="200" (focus)="newBoatForm.controls.description.markAsUntouched()" required></textarea>
                <label for="description" class="input-label">Description</label>
                <span class="error-message error-textarea" *ngIf="newBoatForm.controls.description.touched && newBoatForm.controls.description.errors?.['required']">Description cannot be empty.</span>
            </div>
            <span class="maxchar">0/200max</span>
        </div>
        <div class="form-fields">
            <div class="input-container" [ngClass]="{'input-container-error' : (newBoatForm.controls.street.touched && newBoatForm.controls.street.errors?.['required'])}">
                <input id="street" type="text" formControlName="street" name="street" (focus)="newBoatForm.controls.street.markAsUntouched()" required>
                <label for="street" class="input-label">Street and number</label>
                <span class="error-message" *ngIf="newBoatForm.controls.street.touched && newBoatForm.controls.street.errors?.['required']">Address cannot be empty.</span>
            </div>
        </div>
        <div class="form-fields d-flex flex-row">
            <div class="input-container w-50 me-2" [ngClass]="{'input-container-error' : (newBoatForm.controls.state.touched && newBoatForm.controls.state.errors?.['required'])}">
                <select id="state" name='state' formControlName="state" (change)="onStateChanged()" (focus)="newBoatForm.controls.state.markAsUntouched()">
                    <option *ngFor="let state of states" [value]="state.name">{{state.name}}</option>
                </select>
                <label for="state" class="input-label">State</label>
                <span class="error-message" *ngIf="newBoatForm.controls.state.touched && newBoatForm.controls.state.errors?.['required']">You must choose a state.</span>
            </div>
            <div class="input-container w-50 ms-2" [ngClass]="{'input-container-error' : (newBoatForm.controls.city.touched && newBoatForm.controls.city.errors?.['required'])}">
                <select id="city" name='city' formControlName="city" (focus)="newBoatForm.controls.city.markAsUntouched()">
                    <option *ngFor="let city of filteredCities" [value]="city.name">{{city.name}}</option>
                </select>
                <label for="city" class="input-label">City</label>
                <span class="error-message" *ngIf="newBoatForm.controls.city.touched && newBoatForm.controls.city.errors?.['required']">You must choose a city.</span>
            </div>
        </div>
        <span class="checkbox-text">Choose which rules are applied when renting</span>
        
        <div class="applied-rules-grid">
            <div *ngFor="let appliedRule of appliedRules">
                <label><input type="checkbox" formArrayName="appliedRules"
                        [checked]="newBoatForm.controls['appliedRules'].value.includes(appliedRule)"
                        (value)="appliedRule.description"
                        (change)="appliedRulesChanged($event, appliedRule)"/>
                    <span class="checkbox-label">{{appliedRule.description}}</span>
                </label>
            </div>
        </div>

    </form>
    <app-primary-button [text]="'Next'" class="next-btn" (click)="addGeneralInfo()"></app-primary-button>
</div>
